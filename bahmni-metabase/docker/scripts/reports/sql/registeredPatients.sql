SELECT DISTINCT (@rownum := @rownum + 1) AS \"Sr. No.\", IF(extraIdentifier.identifier IS NULL OR extraIdentifier.identifier = \"\", primaryIdentifier.identifier, extraIdentifier.identifier) AS \"Patient Id\", concat(pn.given_name, \" \", ifnull(pn.family_name, \"\")) AS \"Patient Name\", floor(DATEDIFF(NOW(), p.birthdate) / 365) AS \"Age\",  p.gender AS \"Gender\", DATE_FORMAT(CONVERT_TZ(pt.date_created,\"+00:00\",\"+5:30\"), \"%d-%b-%Y\")                                                                   AS \"Registration Date\"\n\nFROM patient pt\n  JOIN person p ON p.person_id = pt.patient_id AND p.voided is FALSE\n  JOIN person_name pn ON pn.person_id = p.person_id AND pn.voided is FALSE\n  JOIN (SELECT pri.patient_id, pri.identifier \n    FROM patient_identifier pri \n      JOIN patient_identifier_type pit ON pri.identifier_type = pit.patient_identifier_type_id AND pit.retired is FALSE\n      JOIN global_property gp ON gp.property=\"bahmni.primaryIdentifierType\" AND INSTR (gp.property_value, pit.uuid)) primaryIdentifier \n\t\tON pt.patient_id = primaryIdentifier.patient_id\t\t\n  LEFT OUTER JOIN (SELECT ei.patient_id, ei.identifier \n    FROM patient_identifier ei \n      JOIN patient_identifier_type pit ON ei.identifier_type = pit.patient_identifier_type_id AND pit.retired is FALSE\n      JOIN global_property gp ON gp.property=\"bahmni.extraPatientIdentifierTypes\" AND INSTR (gp.property_value, pit.uuid)) extraIdentifier \n\t\tON pt.patient_id = extraIdentifier.patient_id\n  CROSS JOIN (SELECT @rownum := 0) AS dummy\n  WHERE pt.voided is FALSE\n  AND cast(CONVERT_TZ(pt.date_created,\"+00:00\",\"+5:30\") AS DATE) BETWEEN STR_TO_DATE(\"04-05-2017\", \"%d-%m-%Y\") \n        AND STR_TO_DATE(\"30-06-2017\", \"%d-%m-%Y\");